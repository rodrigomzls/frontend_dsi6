<!-- header.component.html -->
<header class="header">
  <!-- Logo clickeable -->
  <div class="logo" (click)="irAlInicio()">
    <img src="../../../assets/company-logo.png" alt="Logo Viña" class="logo-img">
    <span class="logo-text">Viña</span>
  </div>

  <!-- Navegación -->
  <nav class="nav-links" *ngIf="isLoggedIn">
    <!-- Ventas -->
    <button mat-button [matMenuTriggerFor]="ventasMenu" *ngIf="tieneAccesoAVentas()">
      <mat-icon>point_of_sale</mat-icon>
      Ventas
    </button>
    <mat-menu #ventasMenu="matMenu">
      <button mat-menu-item *ngIf="tieneAcceso('ventas_nueva')" (click)="nuevaVenta()">
        <mat-icon>add_shopping_cart</mat-icon>
        Nueva Venta
      </button>
      <button mat-menu-item *ngIf="tieneAcceso('ventas')" (click)="goToVentas()">
        <mat-icon>receipt_long</mat-icon>
        Panel de Ventas
      </button>
    </mat-menu>

    <!-- Productos -->
    <button mat-button *ngIf="tieneAcceso('productos')" (click)="goToProductos()">
      <mat-icon>inventory_2</mat-icon>
      Productos
    </button>

    <!-- SUNAT -->
    <button mat-button *ngIf="tieneAcceso('sunat')" (click)="goToSunat()">
      <mat-icon>receipt_long</mat-icon>
      SUNAT
    </button>

    <!-- Gestión -->
    <button mat-button [matMenuTriggerFor]="gestionMenu" *ngIf="tieneAccesoAGestion()">
      <mat-icon>manage_accounts</mat-icon>
      Gestión
    </button>
    <mat-menu #gestionMenu="matMenu">
      <button mat-menu-item *ngIf="tieneAcceso('usuarios')" (click)="goToUsuarios()">
        <mat-icon>people</mat-icon>
        Gestión de Usuarios
      </button>
      <button mat-menu-item *ngIf="tieneAcceso('personas')" (click)="goToPersonas()">
        <mat-icon>person</mat-icon>
        Gestión de Personas
      </button>
      <button mat-menu-item *ngIf="tieneAcceso('clientes')" (click)="goToClientes()">
        <mat-icon>groups</mat-icon>
        Gestión de Clientes
      </button>
      <button mat-menu-item *ngIf="tieneAcceso('repartidores')" (click)="goToRepartidores()">
        <mat-icon>local_shipping</mat-icon>
        Gestión de Repartidores
      </button>
    </mat-menu>

    <!-- Rutas -->
    <button mat-button [matMenuTriggerFor]="rutasMenu" *ngIf="tieneAccesoARutas()">
      <mat-icon>route</mat-icon>
      Rutas
    </button>
    <mat-menu #rutasMenu="matMenu">
      <button mat-menu-item *ngIf="tieneAcceso('ventas_asignacion_rutas')" (click)="goToRutas()">
        <mat-icon>add_road</mat-icon>
        Asignación de Rutas
      </button>
      <button mat-menu-item *ngIf="tieneAcceso('rutas_asignadas')" (click)="goToRutasAsignadas()">
        <mat-icon>map</mat-icon>
        Mis Rutas
      </button>
    </mat-menu>

    <!-- Entregas (Repartidor) -->
    <button mat-button [matMenuTriggerFor]="entregasMenu" *ngIf="tieneAccesoAEntregas()">
      <mat-icon>local_shipping</mat-icon>
      Entregas
    </button>
    <mat-menu #entregasMenu="matMenu">
      <button mat-menu-item *ngIf="tieneAcceso('entregas_pendientes')" (click)="goToEntregas()">
        <mat-icon>pending_actions</mat-icon>
        Entregas Pendientes
      </button>
      <button mat-menu-item *ngIf="tieneAcceso('historial_entregas')" (click)="verHistorialEntregas()">
        <mat-icon>history</mat-icon>
        Historial de Entregas
      </button>
    </mat-menu>

    <!-- ✅ ACTUALIZADO: Inventario Unificado (Almacenero) -->
    <button mat-button [matMenuTriggerFor]="inventarioMenu" *ngIf="tieneAccesoAInventario()">
      <mat-icon>warehouse</mat-icon>
      Inventario
    </button>
    <mat-menu #inventarioMenu="matMenu">
      <!-- ✅ NUEVO: Dashboard Unificado -->
      <button mat-menu-item *ngIf="tieneAcceso('inventario')" (click)="goToInventarioUnificado()">
        <mat-icon>dashboard</mat-icon>
        Dashboard de Inventario
      </button>

     

      <mat-divider></mat-divider>

      <!-- ✅ MANTENER: Reportes -->
      <button mat-menu-item *ngIf="tieneAcceso('inventario_reportes')" (click)="verReportes()">
        <mat-icon>assessment</mat-icon>
        Reportes de Stock
      </button>

      <!-- ✅ MANTENER: Proveedores y Categorías -->
      <button mat-menu-item *ngIf="tieneAcceso('proveedores')" (click)="goToProveedores()">
        <mat-icon>local_shipping</mat-icon>
        Proveedores
      </button>
      <button mat-menu-item *ngIf="tieneAcceso('pedido_proveedor')" (click)="goPedidosProveedor()">
        <mat-icon>list_alt</mat-icon>
        Pedidos a Proveedor
      </button>
      <button mat-menu-item *ngIf="tieneAcceso('categorias')" (click)="goCategorias()">
        <mat-icon>category</mat-icon>
        Categorías
      </button>
      <button mat-menu-item *ngIf="tieneAcceso('marcas')" (click)="goMarcas()">
        <mat-icon>branding_watermark</mat-icon>
        Marcas
      </button>
    </mat-menu>
  </nav>

  <!-- Lado derecho -->
  <div class="user-actions" *ngIf="isLoggedIn">
    <button mat-button class="user-btn" [matMenuTriggerFor]="userMenu">
      <mat-icon>account_circle</mat-icon>
      {{ nombreUsuario }}
    </button>

    <mat-menu #userMenu="matMenu">
      <button mat-menu-item (click)="irAlInicio()">
        <mat-icon>home</mat-icon>
        Inicio
      </button>
      <mat-divider></mat-divider>
      <button mat-menu-item (click)="logout()">
        <mat-icon>logout</mat-icon>
        Cerrar sesión
      </button>
    </mat-menu>
  </div>
</header>