<!-- pedido-detalles-modal.component.html - ESTRUCTURA CORREGIDA -->
<div class="detalles-modal-container">
  <!-- Header -->
  <div class="modal-header">
    <h2 mat-dialog-title class="modal-title">
      <mat-icon class="title-icon">list_alt</mat-icon>
      Detalles del Pedido #{{ data.pedido.id_pedido }}
    </h2>
    <button mat-icon-button (click)="onClose()" class="close-btn">
      <mat-icon>close</mat-icon>
    </button>
  </div>

  <!-- Contenido principal SIN scroll -->
  <mat-dialog-content class="modal-content">
    <!-- Información General -->
    <div class="info-section">
      <h3 class="section-title">
        <mat-icon>info</mat-icon>
        Información General
      </h3>
      <div class="info-grid">
        <div class="info-item">
          <span class="info-label">Proveedor:</span>
          <span class="info-value">{{ data.pedido.proveedor?.razon_social || 'No especificado' }}</span>
        </div>
        <div class="info-item">
          <span class="info-label">Fecha:</span>
          <span class="info-value">{{ data.pedido.fecha | date:'dd/MM/yyyy' }}</span>
        </div>
        <div class="info-item">
          <span class="info-label">Estado:</span>
          <span class="info-value estado-badge" 
                [class]="'estado-' + (data.pedido.estado?.estado?.toLowerCase()?.replace(' ', '-') || 'desconocido')">
            <mat-icon class="estado-icon">{{ getEstadoIcon(data.pedido.estado?.estado) }}</mat-icon>
            {{ data.pedido.estado?.estado || 'Desconocido' }}
          </span>
        </div>
        <div class="info-item">
          <span class="info-label">Total:</span>
          <span class="info-value total-amount">{{ data.pedido.total | currency:'PEN':'S/ ' }}</span>
        </div>
      </div>
    </div>

    <!-- Detalles de Insumos CON SCROLL PROPIO -->
    <div class="detalles-section">
      <div class="section-header">
        <h3 class="section-title">
          <mat-icon>inventory_2</mat-icon>
          Insumos del Pedido
        </h3>
        <div class="items-count-badge" *ngIf="data.pedido.detalles.length > 0">
          {{ data.pedido.detalles.length }} items
        </div>
      </div>
      
      <!-- Contenedor de scroll para detalles -->
      <div class="detalles-scroll-container" *ngIf="data.pedido.detalles.length > 0">
        <div class="detalles-list" [class.compact-view]="data.pedido.detalles.length > 3">
          <div *ngFor="let detalle of data.pedido.detalles; let i = index" class="detalle-item">
            <div class="detalle-header">
              <div class="item-info">
                <div class="item-name">{{ detalle.insumo?.nombre || 'Insumo no especificado' }}</div>
                <span class="unidad-medida">
                  <mat-icon>scale</mat-icon>
                  {{ detalle.insumo?.unidad_medida || 'No especificada' }}
                </span>
              </div>
              <div class="item-subtotal">{{ detalle.subtotal | currency:'PEN':'S/ ' }}</div>
            </div>
            
            <div class="detalle-cantidades">
              <div class="cantidad-item">
                <span class="label">Cantidad</span>
                <span class="value">{{ detalle.cantidad | number }}</span>
              </div>
              <div class="cantidad-item">
                <span class="label">Costo Unit.</span>
                <span class="value">{{ detalle.costo_unitario | currency:'PEN':'S/ ' }}</span>
              </div>
              <div class="cantidad-item">
                <span class="label">Subtotal</span>
                <span class="value subtotal">{{ detalle.subtotal | currency:'PEN':'S/ ' }}</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="no-items" *ngIf="data.pedido.detalles.length === 0">
        <mat-icon>inventory</mat-icon>
        <p>No hay insumos en este pedido</p>
      </div>
    </div>
  </mat-dialog-content>

  <!-- Acciones fijas -->
  <mat-dialog-actions align="end" class="modal-actions">
    <button mat-button (click)="onClose()" class="cancel-btn">
      <mat-icon>close</mat-icon>
      Cerrar
    </button>
    <button mat-raised-button color="primary" (click)="onEdit()" class="edit-btn"
            *ngIf="data.pedido.id_estado_pedido !== 4 && data.pedido.id_estado_pedido !== 5">
      <mat-icon>edit</mat-icon>
      Editar Pedido
    </button>
  </mat-dialog-actions>
</div>